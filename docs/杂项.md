# 誉存食府（微信版）


## 数据表

- User: 用户表，每个微信用户会话创建一个actor，用户使用公司邮箱进行绑定操作。绑定后需要管理员审核，审核通过才有点餐权限
- Menu: 菜单表，保存每天的菜单
- MealHistory: 订餐表，存储每个用户的订餐记录


## Actor

所有微信会话均通过UserMaster预处理并分派，根据openid指定给对应UserWorker进行消息命令的实际处理流程


### 一级指令

0: 命令列表
1: 注册 - 绑定账号
2: 点菜 - 当日菜单（已点菜则显示已点菜品）
3: 历史记录

### 流程

0. 用户提交公司邮箱进行注册，管理员审核通过后完成注册并用户拥有定餐权限
1. 每天定时发邮件提醒管理员提交菜单
2. 管理员登录后台提交菜单，系统自动群发消息当日菜单
3. 用户定餐
4. 用户查看当日定餐状态（已定餐用户可选择重定）
5. 截止时间，系统停止所有用户定餐。并生成定餐列表发邮件给管理员
6. 管理员登录后台查看当日定餐状态



使用Cache缓存每天的当日菜单
